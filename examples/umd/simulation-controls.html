<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Network Visualization Example</title>

    <style>
      body {
        margin: 0;
        font-family: system-ui, sans-serif;
      }
      canvas {
        display: block;
      }
    </style>

    <script
      crossorigin
      src="https://unpkg.com/preact@latest/dist/preact.umd.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/preact@latest/hooks/dist/hooks.umd.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/preact@latest/compat/dist/compat.umd.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/three@latest/build/three.min.js"
    ></script>
    <script>
      var React = preactCompat
    </script>
    <script
      crossorigin
      src="https://unpkg.com/@acdh/network-visualization@latest/lib/network-visualization.umd.js"
    ></script>
  </head>
  <body>
    <div id="visualization" style="background: #fafafa;"></div>
    <script>
      const { createElement: h, render, useState } = preactCompat
      const { SelectionControls } = NetworkVisualization

      const dimensions = 2

      const graph = {
        nodes: [
          { id: 'n1', label: 'Node 1', type: 't1' },
          { id: 'n2', label: 'Node 2', type: 't2' },
          { id: 'n3', label: 'Node 3', type: 't2' },
        ],
        edges: [
          {
            id: 'e1',
            label: 'Edge 1',
            source: 'n1',
            target: 'n2',
            type: 'r1',
          },
          {
            id: 'e2',
            label: 'Edge 2',
            source: 'n1',
            target: 'n3',
            type: 'r1',
          },
          {
            id: 'e3',
            label: 'Edge 3',
            source: 'n2',
            target: 'n3',
            type: 'r1',
          },
        ],
        types: {
          nodes: [
            { id: 't1', label: 'Category 1', color: '#006699' },
            { id: 't2', label: 'Category 2', color: '#669900' },
          ],
          edges: [{ id: 'r1', label: 'Relation 1', color: '#990066' }],
        },
      }

      const Applet = () => {
        const [charge, setCharge] = useState(-75)
        const [distance, setDistance] = useState(10)

        const setValue = (_value, cb) => {
          const value = parseInt(_value, 10)
          if (Number.isInteger(value)) {
            cb(value)
          }
        }

        return h(
          'div',
          {
            style: {
              display: 'flex',
              minHeight: '100vh',
              position: 'relative',
            },
          },
          [
            h(
              'form',
              undefined,
              h('fieldset', undefined, [
                h('legend', undefined, 'Simulation'),
                h(
                  'div',
                  {
                    style: {
                      display: 'grid',
                      gridGap: '10px',
                      gridTemplateColumns: 'auto 1fr',
                    },
                  },
                  [
                    h('label', undefined, 'Charge:'),
                    h('input', {
                      type: 'number',
                      value: charge,
                      onChange: e => setValue(e.target.value, setCharge),
                    }),
                    h('label', undefined, 'Distance:'),
                    h('input', {
                      type: 'number',
                      value: distance,
                      onChange: e => setValue(e.target.value, setDistance),
                    }),
                  ]
                ),
              ])
            ),

            h(
              'div',
              { style: { position: 'relative', flex: 1 } },
              h(SelectionControls, {
                dimensions,
                graph,
                simulation: { charge, distance },
              })
            ),
          ]
        )
      }

      render(h(Applet), document.getElementById('visualization'))
    </script>
  </body>
</html>
